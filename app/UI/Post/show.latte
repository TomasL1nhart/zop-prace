{block content}
<div class="post-container">

    {ifset $isArchivedAndRestricted}
    <p class="alert">Tento pÅ™Ã­spÄ›vek je archivovanÃ½ a nenÃ­ veÅ™ejnÄ› dostupnÃ½.</p>

    {elseifset $notFound}
        <p class="alert">PÅ™Ã­spÄ›vek nebyl nalezen.</p>

    {else}
    <h1 class="post-title">{$post->title}</h1>
    <h2 class="post-author">Autor: {$post->user->username}</h2>
    
    <div class="post-status">
        Stav: 
        {if $post->status === 'OPENED'}
            <span style="color: green; font-weight: bold;">OtevÅ™enÃ½</span>
        {elseif $post->status === 'CLOSED'}
            <span style="color: orange; font-weight: bold;">UzavÅ™enÃ½</span>
        {elseif $post->status === 'ARCHIVED'}
            <span style="color: gray; font-weight: bold;">ArchivovanÃ½</span>
        {/if}
    </div>
    
    <p class="post-category">Kategorie: {$post->ref('categories', 'category_id')->name}</p>

    <hr class="post-separator">

    <div class="post-content-box">
        {nl2br($post->content)|noescape}
    </div>

    {if $post->image}
        <div class="post-image-wrapper">
            <img src="{$basePath}/uploads/{$post->image}" alt="ObrÃ¡zek k pÅ™Ã­spÄ›vku" class="post-image" draggable="false" />
        </div>
    {/if}

    <hr class="post-separator">

    {if $user->isLoggedIn() && ($user->isInRole('admin') || ($user->id === $post->user_id))}
    <a href="{link Edit:edit id => $post->id}" class="post-btn">âœï¸ Upravit</a>
    {/if}

    <h2 class="comments-title">KomentÃ¡Å™e ({count($comments)})</h2>

    {foreach $comments as $comment}
    <div class="comment-box">
        <strong>{$comment->user->username}</strong>
        <p>{$comment->text}</p>

        {if $user->isLoggedIn() && ($user->id === $comment->user_id || $user->isInRole('admin'))}
            <a n:href="deleteComment! $comment->id" class="delete-comment" onclick="return confirm('Opravdu chcete smazat tento komentÃ¡Å™?');">ğŸ—‘ï¸ Smazat</a>
        {/if}
    </div>
    {/foreach}


    {if $user->isLoggedIn() && ($post->status !== 'ARCHIVED' || $user->isInRole('admin'))}
    <form n:name="commentForm" class="comment-form">
        <textarea n:name="comment" class="comment-textarea" placeholder="NapiÅ¡te svÅ¯j komentÃ¡Å™..." rows="4"></textarea>
        <button type="submit" class="post-btn">Odeslat</button>
    </form>
    {/if}

    {if $user->isLoggedIn() && ($user->id === $post->user_id || $user->isInRole('admin'))}
        <form n:name="deleteForm" style="margin-top: 20px;">
            <button class="btn btn-danger" onclick="return confirm('Opravdu chcete smazat tento pÅ™Ã­spÄ›vek?');">
                Smazat pÅ™Ã­spÄ›vek
            </button>
        </form>
    {/if}
{/ifset}

</div>
{/block}
